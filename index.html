<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Potter Card Game</title><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"><script defer="defer" src="./runtime.e5751729add0e020065e.js"></script><script defer="defer" src="./vendors.66a7e41d5abff7ab27c7.js"></script><script defer="defer" src="./main.57b117cf14691865477b.js"></script><link href="./main.00e242267786bfbcf229.css" rel="stylesheet"></head><body><div id="notification" class="notification"></div><div id="setup-modal" class="modal"><div class="modal-content setup-modal-content"><div class="modal-header setup-modal-header"><h2 class="setup-title">Potter Card Game</h2><p class="setup-subtitle">Configure your game settings</p><button id="close-setup-btn" class="setup-close-btn"><span class="btn-icon">✕</span></button></div><div class="setup-mode-selector"><h3 class="setup-section-title">Game Mode</h3><div class="mode-options"><label class="mode-option"><input type="radio" name="game-mode" value="single-player" id="single-player-mode" checked="checked"><div class="mode-option-content"><span class="mode-icon">🤖</span><div class="mode-text"><span class="mode-title">Single Player</span> <span class="mode-description">Play against AI opponents</span></div></div></label> <label class="mode-option"><input type="radio" name="game-mode" value="multiplayer" id="multiplayer-mode"><div class="mode-option-content"><span class="mode-icon">🌐</span><div class="mode-text"><span class="mode-title">Multiplayer</span> <span class="mode-description">Play with friends online</span></div></div></label></div></div><div id="single-player-config" class="setup-form"><div class="setup-section"><h3 class="setup-section-title">Game Configuration</h3><div class="setup-grid-optimized"><div class="setup-field"><label for="player-count" class="setup-label-optimized"><span class="setup-icon">👥</span> <span class="setup-label-text">Total Players</span> <span class="setup-range">(2-5)</span></label><div class="setup-input-wrapper"><input type="number" id="player-count" min="2" max="5" value="4" class="setup-input-optimized"><div class="setup-input-buttons"><button type="button" class="setup-stepper" data-action="increase" data-target="player-count">+</button> <button type="button" class="setup-stepper" data-action="decrease" data-target="player-count">−</button></div></div></div><div class="setup-field"><label for="human-count" class="setup-label-optimized"><span class="setup-icon">🧑</span> <span class="setup-label-text">Human Players</span> <span class="setup-range">(1-5)</span></label><div class="setup-input-wrapper"><input type="number" id="human-count" min="1" max="5" value="1" class="setup-input-optimized"><div class="setup-input-buttons"><button type="button" class="setup-stepper" data-action="increase" data-target="human-count">+</button> <button type="button" class="setup-stepper" data-action="decrease" data-target="human-count">−</button></div></div></div><div class="setup-field"><label for="target-score" class="setup-label-optimized"><span class="setup-icon">🎯</span> <span class="setup-label-text">Target Score</span> <span class="setup-range">(50-500)</span></label><div class="setup-input-wrapper"><input type="number" id="target-score" min="50" max="500" step="25" value="200" class="setup-input-optimized"><div class="setup-input-buttons"><button type="button" class="setup-stepper" data-action="increase" data-target="target-score" data-step="25">+</button> <button type="button" class="setup-stepper" data-action="decrease" data-target="target-score" data-step="25">−</button></div></div></div><div class="setup-field"><label for="ai-difficulty" class="setup-label-optimized"><span class="setup-icon">🧠</span> <span class="setup-label-text">AI Difficulty</span></label><div class="setup-input-wrapper"><select id="ai-difficulty" class="setup-input-optimized setup-select"><option value="easy">Easy</option><option value="medium" selected="selected">Medium</option><option value="hard">Hard</option><option value="expert">Expert</option></select></div></div></div><div class="setup-info"><div class="setup-info-item"><span class="setup-info-label">AI Players:</span> <span id="ai-count-display" class="setup-info-value">3</span></div><div class="setup-info-item"><span class="setup-info-label">Cards per Player:</span> <span class="setup-info-value">8</span></div></div></div></div><div id="multiplayer-config" class="setup-form" style="display: none;"><div class="setup-section"><div class="multiplayer-tabs"><button class="tab-button active" data-tab="create-room"><span class="btn-icon">🏠</span>Create Room</button> <button class="tab-button" data-tab="join-room"><span class="btn-icon">🚪</span>Join Room</button></div><div id="create-room-tab" class="tab-content active"><h3 class="setup-section-title">Create New Room</h3><div class="setup-grid-optimized"><div class="setup-field"><label for="room-name" class="setup-label-optimized"><span class="setup-icon">🏷️</span> <span class="setup-label-text">Room Name</span></label><div class="setup-input-wrapper"><input id="room-name" placeholder="Enter room name" class="setup-input-optimized" maxlength="30"></div></div><div class="setup-field"><label for="room-password" class="setup-label-optimized"><span class="setup-icon">🔒</span> <span class="setup-label-text">Password</span> <span class="setup-range">(Optional)</span></label><div class="setup-input-wrapper"><input type="password" id="room-password" placeholder="Leave empty for public room" class="setup-input-optimized" maxlength="20"></div></div><div class="setup-field"><label for="room-max-players" class="setup-label-optimized"><span class="setup-icon">👥</span> <span class="setup-label-text">Max Players</span> <span class="setup-range">(2-5)</span></label><div class="setup-input-wrapper"><input type="number" id="room-max-players" min="2" max="5" value="4" class="setup-input-optimized"><div class="setup-input-buttons"><button type="button" class="setup-stepper" data-action="increase" data-target="room-max-players">+</button> <button type="button" class="setup-stepper" data-action="decrease" data-target="room-max-players">−</button></div></div></div><div class="setup-field"><label for="room-target-score" class="setup-label-optimized"><span class="setup-icon">🎯</span> <span class="setup-label-text">Target Score</span> <span class="setup-range">(50-500)</span></label><div class="setup-input-wrapper"><input type="number" id="room-target-score" min="50" max="500" step="25" value="200" class="setup-input-optimized"><div class="setup-input-buttons"><button type="button" class="setup-stepper" data-action="increase" data-target="room-target-score" data-step="25">+</button> <button type="button" class="setup-stepper" data-action="decrease" data-target="room-target-score" data-step="25">−</button></div></div></div></div></div><div id="join-room-tab" class="tab-content" style="display: none;"><h3 class="setup-section-title">Available Rooms</h3><div class="room-browser"><div class="room-browser-header"><button id="refresh-rooms-btn" class="setup-btn setup-btn-secondary small"><span class="btn-icon">🔄</span>Refresh</button><div class="room-search"><input id="room-search" placeholder="Search rooms..." class="setup-input-optimized small"></div></div><div class="room-list" id="room-list"><div class="room-list-empty"><span class="empty-icon">🏠</span><p>No rooms available</p><p class="empty-hint">Create a room or wait for others to create one</p></div></div></div></div></div></div><div id="lobby-interface" class="setup-form" style="display: none;"><div class="setup-section"><div class="lobby-header"><h3 class="setup-section-title"><span id="lobby-room-name">Room Name</span> <span class="room-status" id="lobby-room-status">Waiting for players</span></h3><button id="leave-room-btn" class="setup-btn setup-btn-secondary small"><span class="btn-icon">🚪</span>Leave Room</button></div><div class="lobby-container"><div class="lobby-left"><div class="player-list-section"><h4 class="lobby-section-title">Players <span id="player-count-display">(1/4)</span></h4><div class="player-list" id="lobby-player-list"></div></div></div><div class="lobby-right"><div class="chat-section"><h4 class="lobby-section-title">Chat</h4><div class="chat-container"><div class="chat-messages" id="lobby-chat-messages"><div class="chat-message system"><span class="chat-text">Welcome to the room! Use chat to communicate with other players.</span></div></div><div class="chat-input-container"><input id="lobby-chat-input" placeholder="Type a message..." class="setup-input-optimized chat-input" maxlength="200"> <button id="send-chat-btn" class="setup-btn setup-btn-primary small"><span class="btn-icon">📤</span></button></div></div></div></div></div><div class="lobby-controls"><button id="ready-toggle-btn" class="setup-btn setup-btn-primary" data-ready="false"><span class="btn-icon">✋</span> <span class="btn-text">Ready</span></button> <button id="start-multiplayer-game-btn" class="setup-btn setup-btn-primary" style="display: none;" disabled="disabled"><span class="btn-icon">🎮</span> <span class="btn-text">Start Game</span></button> <button id="room-settings-btn" class="setup-btn setup-btn-secondary" style="display: none;"><span class="btn-icon">⚙️</span> <span class="btn-text">Room Settings</span></button></div></div></div><div class="setup-actions" id="setup-actions"><button id="start-game-btn" class="setup-btn setup-btn-primary"><span class="btn-icon">🎮</span> <span class="btn-text">Start New Game</span></button> <button id="load-saved-game-btn" class="setup-btn setup-btn-secondary"><span class="btn-icon">📂</span> <span class="btn-text">Load Saved Game</span></button> <button id="create-room-btn" class="setup-btn setup-btn-primary" style="display: none;"><span class="btn-icon">🏠</span> <span class="btn-text">Create Room</span></button></div></div></div><div id="meld-selection-modal" class="modal" style="display: none;"><div class="meld-modal-content"><div class="meld-modal-header"><h3 class="text-2xl font-bold mb-2">Choose Your Meld</h3><p class="text-gray-300 mb-4">Multiple valid melds found. Choose which one to play:</p></div><div id="meld-options" class="meld-options"></div><div class="meld-modal-actions"><button id="cancel-meld-btn" class="cancel-meld-btn"><span class="btn-icon">❌</span>Cancel</button></div></div></div><div id="rules-modal" class="modal" style="display: none;"><div class="rules-modal-content"><div class="rules-modal-header"><div><h2 class="rules-modal-title"><span>📜</span> <span id="rules-title-text">Potter Card Game Rules</span></h2><p class="rules-modal-subtitle" id="rules-subtitle-text">සෙල්ලමේ නීති සරලව - Complete Game Guide</p></div><div class="rules-header-controls"><div class="language-toggle-container"><label class="language-toggle-label">Language:</label><div class="language-toggle-buttons"><button id="lang-si-btn" class="language-toggle-btn active" data-lang="si"><span class="lang-flag">🇱🇰</span> <span class="lang-text">සිං</span></button> <button id="lang-en-btn" class="language-toggle-btn" data-lang="en"><span class="lang-flag">🇬🇧</span> <span class="lang-text">EN</span></button></div></div><button id="close-rules-btn" class="rules-close-btn"><span>✕</span></button></div></div><div class="rules-modal-body"><nav class="rules-nav"><div class="rules-nav-title"><span>🧭</span> Quick Navigation</div><ul class="rules-nav-list" id="rules-nav-list"></ul></nav><div class="rules-content-area"><div class="rules-search-container"><div class="rules-search-icon">🔍</div><input id="rules-search-input" class="rules-search-input" placeholder="නීති සොයන්න... (උදා: 'පෝටර්', 'සල්ලන්', 'ලකුණු')"></div><div id="rules-content"></div></div></div></div></div><div id="game-container" class="game-container"><header class="game-header"><div class="header-left"><h1 class="game-title">Potter Card Game</h1><div class="game-info"><div class="info-badge"><span class="info-label">Round</span><span id="round-number" class="info-value">1</span></div><div class="info-badge potter-badge"><span class="info-label">Potter</span><span id="potter-value" class="info-value">A</span></div></div></div><div class="header-center"><div class="turn-display"><span class="turn-label">Current Turn</span><div class="turn-info"><span id="current-player" class="current-player-name">Player 1</span> <span id="turn-indicator" class="turn-indicator">Your Turn</span></div></div></div><div class="header-right"><button id="view-rules-btn" class="header-btn"><span class="btn-icon">📜</span>View Rules</button> <button id="new-game-btn" class="header-btn"><span class="btn-icon">🔄</span>New Game</button> <button id="export-log-btn" class="header-btn secondary"><span class="btn-icon">📄</span>Export Log</button> <button id="save-state-btn" class="header-btn secondary" title="Save current game state"><span class="btn-icon">💾</span>Save State</button> <button id="load-state-btn" class="header-btn secondary" title="Load last saved game state"><span class="btn-icon">📂</span>Load State</button></div></header><section class="melds-section"><h3 class="section-title"><span class="title-icon">🃏</span>Table Melds<span class="meld-count" id="meld-count">0</span></h3><div id="table-melds" class="table-melds"><div class="empty-melds"><div class="empty-melds-icon">🎴</div><p class="empty-melds-text">No melds played yet</p><p class="empty-melds-hint">Play your first meld to become Sallan!</p></div></div></section><section class="right-column-section"><section class="scoreboard-section"><h3 class="section-title"><span class="title-icon">🏆</span>Scoreboard</h3><div id="scoreboard" class="scoreboard"></div></section><section class="opponents-section"><h3 class="section-title"><span class="title-icon">🤖</span>Opponents</h3><div id="opponents-top" class="opponents-grid"></div></section></section><section class="hand-and-piles-section"><section class="piles-section"><h3 class="section-title"><span class="title-icon">🎛️</span>Card Piles</h3><div class="pile-container"><div class="pile-group"><h4 class="pile-title">Draw Pile</h4><div class="draw-pile"><div class="card back"><span class="pile-text">DRAW</span></div><div id="draw-count" class="pile-count">52</div></div></div><div class="pile-separator"><div class="separator-line"></div><span class="separator-text">VS</span><div class="separator-line"></div></div><div class="pile-group"><h4 class="pile-title">Discard Pile</h4><div class="discard-pile-container"><div id="discard-pile" class="discard-pile"><span class="empty-pile-text">Empty</span></div><div id="discard-count" class="pile-count">0 cards</div></div></div></div></section><section class="hand-section"><div class="hand-header"><div class="player-info"><h3 id="human-player-name" class="player-name">Your Hand</h3><span id="human-player-status" class="player-status">Normal</span></div><div class="hand-stats"><div class="stat-item"><span class="stat-label">Cards</span><span id="hand-count" class="stat-value">8</span></div><div class="stat-item"><span class="stat-label">Score</span><span id="human-player-score" class="stat-value">0</span></div><div class="stat-item"><span class="stat-label">Selected</span><span id="selected-count" class="stat-value">0</span></div></div></div><div id="player-hand" class="player-hand"></div><div class="player-controls-bottom"><div class="control-groups"><div class="control-groups-left"><div class="control-group primary"><button id="draw-card-btn" class="control-btn primary"><span class="btn-icon">🎴</span><span class="btn-text">Draw Card</span></button><button id="take-pile-btn" class="control-btn warning"><span class="btn-icon">📚</span><span class="btn-text">Take Pile</span></button></div><div class="control-group secondary"><button id="play-meld-btn" class="control-btn success"><span class="btn-icon">🎯</span><span class="btn-text">Play Meld</span></button><button id="end-turn-btn" class="control-btn end-turn"><span class="btn-icon">⏭️</span><span class="btn-text">End Turn</span></button></div></div><div class="control-group tertiary"><button id="clear-meld-btn" class="control-btn danger clear-selection"><span class="btn-icon">🗑️</span><span class="btn-text">Clear</span></button><button id="undo-btn" class="control-btn undo"><span class="btn-icon">↶</span><span class="btn-text">Undo</span></button></div></div></div></section></section></div><div id="potter-choice-modal" class="modal" style="display: none;"><div class="meld-modal-content"><div class="meld-modal-header"><h3 class="text-2xl font-bold mb-2">ඔබගේ තීරණය කුමක්ද? (Your Choice?)</h3><p class="text-gray-300 mb-4">ඔබ තැබූ කාඩ්පත, 'Set' එකේ ඇති 'Potter' කාඩ්පත නිදහස් කිරීමට භාවිතා කළ හැක. කරුණාකර ඔබගේ ක්‍රියාව තෝරන්න:</p></div><div id="potter-choice-context" style="background: rgba(0,0,0,0.2); padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem; text-align: center;"><p style="margin-bottom: 0.5rem;">ඔබගේ කාඩ්පත:</p><div id="choice-hand-card" class="meld-cards-preview" style="justify-content: center; margin-bottom: 1rem;"></div><p style="margin-bottom: 0.5rem;">මේසයේ ඇති 'Set' එක:</p><div id="choice-table-meld" class="meld-cards-preview" style="justify-content: center;"></div></div><div class="meld-modal-actions"><button id="choice-extend-set-btn" class="select-meld-btn" style="background: var(--primary-gradient);"><span class="btn-icon">➕</span> 'Set' එක 4ක් කරන්න</button> <button id="choice-take-potter-btn" class="select-meld-btn" style="background: var(--success-gradient);"><span class="btn-icon">🃏</span> 'Potter' එක අතට ගන්න</button></div><div class="meld-modal-actions" style="margin-top: 1rem;"><button id="choice-cancel-btn" class="cancel-meld-btn"><span class="btn-icon">❌</span> අවලංගු කරන්න (Cancel)</button></div></div></div><div id="potter-run-placement-modal" class="modal" style="display: none;"><div class="modal-content" style="max-width: 600px; width: 90vw;"><div class="modal-header"><h3 style="font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem;">Choose Potter Position</h3><p style="color: #d1d5db; margin-bottom: 1rem;">Where would you like to place your Potter card in this run?</p></div><div class="modal-body"><div style="margin-bottom: 1rem;"><h4 style="font-weight: 600; margin-bottom: 0.5rem;">Current Run:</h4><div id="current-run-display" style="display: flex; gap: 5px; justify-content: center; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 8px;"></div></div><div style="margin-bottom: 1rem;"><h4 style="font-weight: 600; margin-bottom: 0.5rem;">Your Potter Card:</h4><div id="potter-card-display" style="display: flex; justify-content: center; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 8px;"></div></div><div style="margin-bottom: 1rem;"><h4 style="font-weight: 600; margin-bottom: 0.5rem;">Choose position:</h4><div id="placement-options-container" style="display: flex; flex-direction: column; gap: 10px;"></div></div></div><div class="modal-footer"><button id="cancel-potter-placement" style="background: #ef4444; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">Cancel</button></div></div></div><div id="undo-confirmation-modal" class="modal" style="display: none;"><div class="undo-modal-content"><div class="undo-modal-header"><h3 class="text-2xl font-bold mb-2">⚠️ Confirm Undo Action</h3><p class="text-gray-300 mb-4">Are you sure you want to undo your last move?</p></div><div class="undo-warning-box"><div class="warning-icon">⚠️</div><div class="warning-content"><h4 class="warning-title">Penalty Warning</h4><p class="warning-text">Undoing your move will add <strong>25 penalty points</strong> to your score.</p><p class="warning-subtext">This action cannot be undone once confirmed.</p></div></div><div class="undo-player-info"><div class="current-score-info"><span class="score-label">Current Score:</span> <span id="undo-current-score" class="score-value">0</span></div><div class="penalty-arrow">→</div><div class="new-score-info"><span class="score-label">After Penalty:</span> <span id="undo-new-score" class="score-value penalty">25</span></div></div><div class="undo-modal-actions"><button id="confirm-undo-btn" class="undo-confirm-btn"><span class="btn-icon">✓</span>Yes, Undo (+25 penalty)</button> <button id="cancel-undo-btn" class="undo-cancel-btn"><span class="btn-icon">✖</span>Cancel</button></div></div></div><div id="score-summary-modal" class="modal" style="display: none;"><div class="score-summary-modal-content"><div class="score-summary-header"><h2 class="text-3xl font-bold mb-2 text-gradient">🏆 Game Over!</h2><p class="text-gray-300 mb-4">Final Scores & Rankings</p></div><div id="score-summary-content" class="score-summary-content"></div><div class="score-summary-stats"><div class="game-stats"><div class="stat-item"><span class="stat-label">Total Rounds</span> <span id="total-rounds" class="stat-value">0</span></div><div class="stat-item"><span class="stat-label">Target Score</span> <span id="final-target-score" class="stat-value">200</span></div><div class="stat-item"><span class="stat-label">Game Duration</span> <span id="game-duration" class="stat-value">--:--</span></div></div></div><div class="score-summary-actions"><button id="new-game-from-summary-btn" class="summary-btn primary"><span class="btn-icon">🎮</span>New Game</button> <button id="export-final-log-btn" class="summary-btn secondary"><span class="btn-icon">📄</span>Export Log</button> <button id="close-summary-btn" class="summary-btn tertiary"><span class="btn-icon">✖️</span>Close</button></div></div></div><section class="log-section" id="log-section"><h3 class="section-title"><span class="title-icon">📜</span>Game Log<button class="log-toggle-button" id="log-toggle-button">▼</button></h3><div id="game-log" class="game-log"></div></section><script src="log-width-manager.js"></script></body></html>